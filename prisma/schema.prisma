// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id          String   @id @default(cuid())
  name        String
  username    String   @unique
  password    String
  phone       String
  role        UserRole @default(USER)
  isApproved  Boolean  @default(false)
  wardNumber  Int
  localBody   String
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  // Relations
  surveys     Survey[]
  approvedBy  String?
  approver    User?    @relation("UserApprovals", fields: [approvedBy], references: [id])
  approvedUsers User[] @relation("UserApprovals")

  @@map("users")
}

model Survey {
  id                  String             @id @default(cuid())
  name                String
  age                 Int
  education           String
  job                 String
  phone               String
  politicalAffiliation PoliticalAffiliation
  religion            String
  caste               String
  customCaste         String?
  category            String?
  sex                 Sex
  createdAt           DateTime           @default(now())
  updatedAt           DateTime           @updatedAt
  
  // Relations
  createdBy           String
  user                User               @relation(fields: [createdBy], references: [id], onDelete: Cascade)

  @@map("surveys")
}

enum UserRole {
  USER
  WARD_MEMBER
  WARD_SECRETARY
  ADMIN
  SUPER_ADMIN
}

enum PoliticalAffiliation {
  LDF
  UDF
  NDA
  CENTRAL
  OTHERS
}

enum Sex {
  MALE
  FEMALE
  OTHER
}
